<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Diffie-Hellman Key Exchange</title>
</head>
<body style="font-family: Arial; padding: 20px;">
  <h2>Diffie-Hellman Key Exchange</h2>

  <p>Prime number (p): <b id="prime">23</b></p>
  <p>Primitive root (g): <b id="base">5</b></p>

  <label>Enter Alice's Private Key (a):</label>
  <input type="number" id="aliceSecret" />
  <button onclick="performKeyExchange()">Generate Keys</button>

  <h3>Output:</h3>
  <div id="output" style="white-space: pre-wrap; background: #f4f4f4; padding: 10px; border: 1px solid #ccc;"></div>

  <script>
    function modPow(base, exponent, modulus) {
      let result = 1;
      base = base % modulus;
      while (exponent > 0) {
        if (exponent % 2 === 1) {
          result = (result * base) % modulus;
        }
        exponent = Math.floor(exponent / 2);
        base = (base * base) % modulus;
      }
      return result;
    }

    function performKeyExchange() {
      const p = 23;  // prime number
      const g = 5;   // primitive root

      const a = parseInt(document.getElementById("aliceSecret").value); // Alice's private key
      if (isNaN(a)) {
        alert("Please enter a valid number for Alice's private key.");
        return;
      }

      const A = modPow(g, a, p); // Alice's public key

      const b = Math.floor(Math.random() * 10) + 1; // Bob's private key (randomly generated)
      const B = modPow(g, b, p); // Bob's public key

      const aliceShared = modPow(B, a, p); // Alice computes shared key
      const bobShared = modPow(A, b, p);   // Bob computes shared key

      const output = `
      Public Prime (p): ${p}
      Primitive Root (g): ${g}

      Alice's Private Key (a): ${a}
      Bob's Private Key (b): ${b} (generated by JavaScript)

      Alice's Public Key (A = g^a mod p): ${A}
      Bob's Public Key (B = g^b mod p): ${B}

       Shared Secret (computed by Alice): ${aliceShared}
       Shared Secret (computed by Bob):   ${bobShared}

       Shared secret is same: ${aliceShared === bobShared}
    `;

      document.getElementById("output").textContent = output;
    }
  </script>
</body>
</html>
